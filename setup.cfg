# =============================================================================
# PyService Mini-ITSM Platform - Code Quality Configuration
# =============================================================================

[flake8]
max-line-length = 120
max-complexity = 10
exclude = 
    .git,
    __pycache__,
    env,
    venv,
    .venv,
    migrations,
    static,
    staticfiles,
    htmlcov,
    .pytest_cache
ignore = 
    E501,  # line too long (handled by black)
    W503,  # line break before binary operator
    E203,  # whitespace before ':'

per-file-ignores =
    __init__.py: F401
    settings.py: E501

[isort]
profile = black
line_length = 120
skip = env,venv,.venv,migrations
known_django = django
known_drf = rest_framework
known_first_party = cmdb,incidents,service_requests,notifications,knowledge,reports,api,core
sections = FUTURE,STDLIB,DJANGO,DRF,THIRDPARTY,FIRSTPARTY,LOCALFOLDER

[tool:pytest]
DJANGO_SETTINGS_MODULE = pyservice.settings
python_files = tests.py test_*.py *_tests.py
addopts = 
    --strict-markers
    -ra
    -q
testpaths = 
    .
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning

[coverage:run]
source = .
branch = True
omit = 
    */migrations/*
    */tests/*
    */test_*
    */__pycache__/*
    env/*
    venv/*
    .venv/*
    manage.py
    */wsgi.py
    */asgi.py
    conftest.py

[coverage:report]
exclude_lines =
    pragma: no cover
    def __repr__
    raise AssertionError
    raise NotImplementedError
    if __name__ == .__main__.:
    if TYPE_CHECKING:
    if settings.DEBUG
show_missing = True
precision = 2
fail_under = 80

[coverage:html]
directory = htmlcov

[black]
line-length = 120
target-version = ['py311']
include = '\.pyi?$'
exclude = '''
/(
    \.eggs
  | \.git
  | \.hg
  | \.mypy_cache
  | \.tox
  | \.venv
  | env
  | venv
  | _build
  | buck-out
  | build
  | dist
  | migrations
)/
'''

[mypy]
python_version = 3.11
warn_return_any = True
warn_unused_configs = True
ignore_missing_imports = True
exclude = 
    migrations/
    env/
    venv/

[bandit]
exclude_dirs = ['tests', 'env', 'venv', '.venv']
skips = ['B101', 'B311']
