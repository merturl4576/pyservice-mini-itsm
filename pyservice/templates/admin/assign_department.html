{% extends "admin/base_site.html" %}
{% load static %}

{% block content %}
<h1>{{ title }}</h1>

<form action="" method="post">
    {% csrf_token %}

    <div style="margin: 20px 0;">
        <h3>Selected Users ({{ users.count }}):</h3>
        <ul>
            {% for user in users %}
            <li>{{ user.username }} - {{ user.get_full_name|default:"No name" }} (Current: {{
                user.department|default:"No department" }})</li>
            {% endfor %}
        </ul>
    </div>

    <div style="margin: 20px 0;">
        {{ form.as_p }}
    </div>

    <div style="margin-top: 20px;">
        <input type="hidden" name="action" value="{{ action }}">
        <input type="hidden" name="_selected_action" value="{{ users|join:" ," }}">
        {% for user in users %}
        <input type="hidden" name="_selected_action" value="{{ user.pk }}">
        {% endfor %}
        <input type="submit" name="apply" value="Assign Department" class="default" style="padding: 10px 20px;">
        <a href="{% url 'admin:cmdb_user_changelist' %}" class="button cancel-link"
            style="padding: 10px 20px; text-decoration: none;">Cancel</a>
    </div>
</form>
{% endblock %}